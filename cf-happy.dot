digraph stack_states {

node [layer=all];
edge [layer=all];

layers="happy"

before_existence [ layer="happy" label="nothing" ]
after_existence [ layer="happy" label="nothing" ]

CREATE_COMPLETE [ layer="happy" ]
CREATE_IN_PROGRESS [ layer="happy" style=dotted ]
DELETE_COMPLETE [ layer="happy" ]
DELETE_IN_PROGRESS [ layer="happy" style=dotted ]
UPDATE_COMPLETE [ layer="happy" ]
UPDATE_COMPLETE_CLEANUP_IN_PROGRESS [ layer="happy" style=dotted label="UPDATE_COMPLETE\nCLEANUP_IN_PROGRESS" ]
UPDATE_IN_PROGRESS [ layer="happy" style=dotted ]

edge [layer=happy];
before_existence -> CREATE_IN_PROGRESS
CREATE_IN_PROGRESS -> CREATE_COMPLETE



edge [layer=happy];
CREATE_COMPLETE -> UPDATE_IN_PROGRESS -> UPDATE_COMPLETE
UPDATE_IN_PROGRESS -> UPDATE_COMPLETE_CLEANUP_IN_PROGRESS -> UPDATE_COMPLETE
UPDATE_COMPLETE -> UPDATE_IN_PROGRESS


edge [layer=happy];
UPDATE_COMPLETE -> DELETE_IN_PROGRESS

CREATE_COMPLETE -> DELETE_IN_PROGRESS
DELETE_IN_PROGRESS -> DELETE_COMPLETE
DELETE_COMPLETE -> after_existence [ label=" 90 days later" ]


}
